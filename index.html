<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ—Ü–∏–∞–ª–µ–Ω –∫–æ–º–ø–∞—Å: –†–æ–±–∏–Ω–∑–æ–Ω –ö—Ä—É–∑–æ –∏ AI</title>
    <link rel="manifest" href="manifest.webmanifest">
    <meta name="theme-color" content="#22c55e">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Font: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            /* –§–æ–Ω —Å —Ç–µ–º–∞—Ç–∏—á–Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∞ –æ—Ç –æ—Å—Ç—Ä–æ–≤ */
            background: linear-gradient(rgba(252, 252, 252, 0.7), rgba(252, 252, 252, 0.7)), 
                        url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            -webkit-tap-highlight-color: transparent;
        }
        
        .motto-animation { 
            animation: fadeInOut 6s infinite; 
        }
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateY(5px); filter: blur(2px); }
            10%, 90% { opacity: 1; transform: translateY(0); filter: blur(0); }
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }
        
        .modal-overlay {
            background: radial-gradient(circle at center, rgba(15, 23, 42, 0.75) 0%, rgba(2, 6, 23, 0.95) 100%);
            backdrop-filter: blur(12px) saturate(180%);
            transition: opacity 0.3s ease;
        }

        .btn-start-gradient {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 10px 25px -5px rgba(16, 185, 129, 0.4);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .btn-start-gradient:active { transform: scale(0.96); }

        .btn-stop-gradient {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 10px 25px -5px rgba(239, 68, 68, 0.4);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .btn-stop-gradient:active { transform: scale(0.96); }

        .progress-bar-fill {
            transition: width 1s linear;
            background: linear-gradient(90deg, #10b981, #34d399);
        }

        .ethics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        @media (max-width: 640px) {
            .ethics-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body class="text-slate-900 min-h-screen flex flex-col items-center select-none overflow-x-hidden">

    <div class="w-full max-w-md min-h-screen flex flex-col p-6 relative">
        
        <header class="text-center mt-4 mb-6 h-20 flex flex-col justify-center">
            <h1 class="text-[9px] font-black text-slate-500 bg-white/40 backdrop-blur-sm self-center px-4 py-1 rounded-full uppercase tracking-[0.5em] mb-3">–ù–∞–≤–∏–≥–∞—Ç–æ—Ä –Ω–∞ –†–æ–±–∏–Ω–∑–æ–Ω</h1>
            <div id="motto-container" class="px-4">
                <p id="motto-display" class="text-emerald-700 text-lg font-black italic motto-animation leading-tight tracking-tight uppercase drop-shadow-sm"></p>
            </div>
        </header>

        <div class="grid grid-cols-2 gap-3 mb-6">
            <div class="glass-card p-4 rounded-3xl text-center">
                <span class="text-[8px] font-bold text-slate-500 uppercase tracking-widest block mb-1">–ö–æ—Ä—Ç–∏–∑–æ–ª</span>
                <div id="cortisol-val" class="text-2xl font-black text-blue-600">0</div>
            </div>
            <div class="glass-card p-4 rounded-3xl text-center">
                <span class="text-[8px] font-bold text-slate-500 uppercase tracking-widest block mb-1">–ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏</span>
                <div id="endorphin-val" class="text-2xl font-black text-emerald-600">0</div>
            </div>
        </div>

        <main class="flex-grow flex flex-col items-center justify-start">
            <div class="w-full glass-card rounded-[2.5rem] p-7 mb-6">
                <div class="flex items-center justify-between mb-5 px-1">
                    <div class="flex flex-col">
                        <h2 class="text-slate-500 text-[9px] font-black uppercase tracking-widest mb-1">–î–∏–≥–∏—Ç–∞–ª–µ–Ω –ø—Ä–µ—Å—Ç–æ–π</h2>
                        <div id="timer-display" class="text-4xl font-black text-slate-800 tracking-tighter tabular-nums">00:00</div>
                    </div>
                    <div class="text-right">
                        <span class="text-[8px] font-bold text-slate-400 uppercase block mb-1">–õ–∏–º–∏—Ç</span>
                        <div class="inline-flex items-center justify-center bg-emerald-100/80 px-3 py-1 rounded-full">
                            <span class="text-[10px] font-black text-emerald-700">45–º</span>
                        </div>
                    </div>
                </div>

                <div class="w-full h-1.5 bg-slate-200/50 rounded-full overflow-hidden mb-8">
                    <div id="timer-progress-bar" class="h-full progress-bar-fill w-0"></div>
                </div>

                <button id="start-btn" class="btn-start-gradient w-full py-5 px-8 rounded-2xl text-white font-bold uppercase tracking-[0.25em] text-[11px] flex items-center justify-center gap-4">
                    <span id="btn-icon" class="text-xs">‚ñ∂</span>
                    <span id="btn-text">–°—Ç–∞—Ä—Ç –Ω–∞ —Ä–µ–∂–∏–º–∞</span>
                </button>
            </div>

            <div class="flex items-center gap-3 px-6 py-3 bg-white/60 backdrop-blur-md rounded-full border border-white/40 shadow-sm">
                <span class="relative flex h-2 w-2">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                </span>
                <p class="text-[10px] text-slate-600 font-bold uppercase tracking-widest">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ –∂–∏–≤–æ</p>
            </div>
        </main>

        <footer class="text-center py-4 text-[8px] text-slate-500 font-bold uppercase tracking-[0.4em] bg-white/20 backdrop-blur-sm rounded-full">
            PBL Project &copy; 2024
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª–∏ -->
    <div id="mission-modal" class="fixed inset-0 modal-overlay z-50 hidden flex items-center justify-center p-6">
        <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-sm text-center shadow-2xl border border-slate-100">
            <div class="text-3xl mb-4 text-orange-500 italic font-black uppercase tracking-tighter">–ö—Ä—É–∑–æ –ê–ª–∞—Ä–º!</div>
            <h3 class="text-[10px] font-bold text-slate-400 mb-5 uppercase tracking-widest">–í—Ä–µ–º–µ –∑–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç</h3>
            <div class="bg-slate-50 rounded-2xl p-6 border border-slate-100 mb-8 text-left">
                <h4 id="mission-title" class="font-black text-emerald-600 text-sm mb-2 uppercase tracking-tight">...</h4>
                <p id="mission-desc" class="text-slate-500 text-xs leading-relaxed italic"></p>
            </div>
            <div class="flex flex-col gap-3">
                <button id="complete-mission-btn" class="w-full btn-start-gradient text-white font-bold py-5 rounded-2xl shadow-md uppercase tracking-widest text-[10px]">–ò–∑–ø—ä–ª–Ω–∏—Ö –ú–∏—Å–∏—è—Ç–∞!</button>
                <button id="refuse-mission-btn" class="w-full text-slate-400 text-[9px] font-bold uppercase tracking-widest hover:text-red-500 transition-colors py-2">–û—Ç–∫–∞–∑–≤–∞–º</button>
            </div>
        </div>
    </div>

    <div id="bravo-modal" class="fixed inset-0 modal-overlay z-50 hidden flex items-center justify-center p-6 text-center">
        <div class="bg-white/95 backdrop-blur-md rounded-[3rem] p-10 max-w-xs shadow-2xl">
            <div class="text-6xl mb-6">üèùÔ∏è</div>
            <h2 class="text-2xl font-black text-slate-800 mb-2 uppercase tracking-tight">–ë—Ä–∞–≤–æ!</h2>
            <p id="bravo-stats" class="text-slate-500 text-[10px] font-bold uppercase tracking-widest mb-10 leading-loose"></p>
            <button onclick="closeBravo()" class="w-full bg-slate-900 text-white font-black py-5 rounded-2xl uppercase tracking-[0.3em] text-[10px]">–ö—ä–º –û—Å—Ç—Ä–æ–≤–∞</button>
        </div>
    </div>

    <div id="ethics-modal" class="fixed inset-0 bg-slate-950/95 z-[60] hidden flex flex-col overflow-y-auto p-6 pt-16">
        <div class="max-w-2xl mx-auto w-full">
            <header class="text-center mb-12">
                <h3 class="text-red-500 text-[11px] font-black uppercase tracking-[0.6em] mb-3">–ï—Ç–∏—á–µ–Ω –§–∏–ª—Ç—ä—Ä</h3>
                <p class="text-white/50 text-[10px] uppercase tracking-widest italic font-bold">–ö–∞–∑—É—Å –ê–¥–∞–º –†–µ–π–Ω</p>
            </header>
            <form id="ethics-form">
                <div class="ethics-grid mb-12" id="ethics-container"></div>
                <p id="ethics-error" class="text-red-500 text-[10px] text-center font-bold uppercase mb-6 hidden">–ú–æ–ª—è, –æ—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ –Ω–∞ –≤—Å–∏—á–∫–∏ –≤—ä–ø—Ä–æ—Å–∏!</p>
                <button type="submit" class="w-full bg-white text-slate-900 font-black py-5 rounded-2xl uppercase tracking-[0.4em] text-[11px] hover:bg-slate-100 transition-colors">–ò–∑–ø—Ä–∞—Ç–∏ –æ—Ç–≥–æ–≤–æ—Ä–∏</button>
            </form>
        </div>
    </div>

    <div id="crisis-panel" class="fixed inset-0 modal-overlay z-[70] hidden flex flex-col items-center justify-center p-8 text-center text-white">
        <div class="bg-red-900/40 p-10 rounded-[3rem] border border-red-800 w-full max-w-sm backdrop-blur-md shadow-[0_0_80px_rgba(220,38,38,0.3)]">
            <div class="bg-white/10 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                <span class="text-2xl animate-pulse">üÜò</span>
            </div>
            <h2 class="text-2xl font-black mb-2 uppercase tracking-tighter">–ö—Ä–∏—Ç–∏—á–Ω–æ –Ω–∞—Å–æ—á–≤–∞–Ω–µ</h2>
            <p class="text-red-200 mb-12 text-[10px] font-bold uppercase tracking-widest opacity-60">–†–∏—Å–∫ –æ—Ç —Å–æ—Ü–∏–∞–ª–Ω–∞ –∏–∑–æ–ª–∞—Ü–∏—è</p>
            <div class="space-y-4 mb-12">
                <div class="bg-white/5 p-5 rounded-2xl border border-white/10">
                    <span class="text-[9px] text-white/30 uppercase block mb-1 tracking-widest">–õ–∏–Ω–∏—è –∑–∞ –ø–æ–¥–∫—Ä–µ–ø–∞</span>
                    <a href="tel:116111" class="text-2xl font-black tracking-tighter">116 111</a>
                </div>
                <div class="bg-white/5 p-5 rounded-2xl border border-white/10">
                    <span class="text-[9px] text-white/30 uppercase block mb-1 tracking-widest">–ë–ß–ö - –ü—Å–∏—Ö–æ–ª–æ–≥</span>
                    <a href="tel:080088001" class="text-2xl font-black tracking-tighter">0 800 88 001</a>
                </div>
            </div>
            <button onclick="finalizeCrisis()" class="w-full bg-white text-red-950 font-black py-5 rounded-2xl uppercase tracking-widest text-[11px]">–†–∞–∑–±—Ä–∞—Ö</button>
        </div>
    </div>

    <script>
        const data = {
            mottos: ["–°–ø–∞–∑–≤–∞–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞", "–ü–æ-–ø—Ä–∏—è—Ç–Ω–æ —Å —á–æ–≤–µ–∫ –¥–æ —Ç–µ–±", "–ß–æ–≤–µ–∫ —Å —á–æ–≤–µ–∫", "–¢—Ä—É–¥—ä—Ç —Å–ø–∞—Å—è–≤–∞", "–í–∏–Ω–∞–≥–∏ –∏–º–∞ –∫–∞–∫"],
            threshold: 45, // –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ 45 –º–∏–Ω—É—Ç–∏
            missions: [
                { title: "–ö–ª—è–∫–∞–Ω–∏—è", desc: "–ù–∞–ø—Ä–∞–≤–∏ 3 —Å–µ—Ä–∏–∏ –ø–æ 15 –∫–ª—è–∫–∞–Ω–∏—è –∑–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ç–æ–Ω—É—Å." },
                { title: "–ì—Ä–µ–±–∞–Ω–µ", desc: "–°–µ–¥–Ω–∏ –∏–∑–ø—Ä–∞–≤–µ–Ω –∏ –Ω–∞–ø—Ä–∞–≤–∏ 20 –ø–æ–≤–¥–∏–≥–∞–Ω–∏—è –Ω–∞ –∫–æ–ª–µ–Ω–µ—Ç–µ –∫—ä–º –≥—ä—Ä–¥–∏—Ç–µ, –∏–º–∏—Ç–∏—Ä–∞–π–∫–∏ –≥—Ä–µ–±–∞–Ω–µ." },
                { title: "–†–∞–∑—Ö–æ–¥–∫–∞", desc: "5 –º–∏–Ω—É—Ç–∏ –±—ä—Ä–∑–æ —Ö–æ–¥–µ–Ω–µ –¥–∞–ª–µ—á –æ—Ç –µ–∫—Ä–∞–Ω–∞." },
                { title: "–ì–∏–º–Ω–∞—Å—Ç–∏–∫–∞", desc: "–ò–∑–ø—ä–Ω–∏ —Ä—ä—Ü–µ –Ω–∞–¥ –≥–ª–∞–≤–∞—Ç–∞ –∏ –Ω–∞–ø—Ä–∞–≤–∏ 10 –∫—Ä—ä–≥–æ–≤–∏ –¥–≤–∏–∂–µ–Ω–∏—è." }
            ],
            ethics: [
                "–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç–µ –ª–∏ –¥–∞ —Å–∏ –≥–æ–≤–æ—Ä–∏—Ç–µ —Å AI –≤–º–µ—Å—Ç–æ —Å –∂–∏–≤ —á–æ–≤–µ–∫?",
                "–ü—Ä–æ–ø—É—Å–∫–∞—Ç–µ –ª–∏ —Ö—Ä–∞–Ω–µ–Ω–µ –∑–∞—Ä–∞–¥–∏ –∫–æ–º–ø—é—Ç—ä—Ä–∞?",
                "–ù–∞–º–∏—Ä–∞—Ç–µ –ª–∏ —É—Ç–µ—Ö–∞ –≤ –¥–∏–≥–∏—Ç–∞–ª–Ω–∏—è —Å–≤—è—Ç?",
                "–õ—ä–∂–µ—Ç–µ –ª–∏ –∑–∞ –≤—Ä–µ–º–µ—Ç–æ —Å–∏ –æ–Ω–ª–∞–π–Ω?",
                "–ì—É–±–∏—Ç–µ –ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∞ –∑–∞ —Ä–µ–∞–ª–Ω–æ—Å—Ç—Ç–∞?",
                "–ü—Ä–µ–Ω–µ–±—Ä–µ–≥–≤–∞—Ç–µ –ª–∏ –ø—Ä–∏—è—Ç–µ–ª–∏—Ç–µ —Å–∏?"
            ]
        };

        let state = { seconds: 0, isRunning: false, cortisol: 0, endorphins: 0 };
        let timerInterval;

        const timerDisplay = document.getElementById('timer-display');
        const progressBar = document.getElementById('timer-progress-bar');
        const startBtn = document.getElementById('start-btn');

        let mottoIdx = 0;
        function rotateMottos() {
            const display = document.getElementById('motto-display');
            if (display) {
                display.textContent = data.mottos[mottoIdx];
                mottoIdx = (mottoIdx + 1) % data.mottos.length;
            }
        }
        setInterval(rotateMottos, 6000); rotateMottos();

        startBtn.addEventListener('click', () => {
            if (state.isRunning) stopTimer(); else startTimer();
        });

        function startTimer() {
            state.isRunning = true;
            document.getElementById('btn-text').textContent = "–ü–∞—É–∑–∞";
            document.getElementById('btn-icon').textContent = "‚è∏";
            startBtn.classList.replace('btn-start-gradient', 'btn-stop-gradient');
            
            timerInterval = setInterval(() => {
                state.seconds++;
                updateUI();
                // –ù–∞ –≤—Å–µ–∫–∏ 5 –º–∏–Ω—É—Ç–∏ (300—Å) –∫–∞—á–≤–∞–º–µ –∫–æ—Ä—Ç–∏–∑–æ–ª–∞
                if (state.seconds % 300 === 0) { state.cortisol += 5; updateStats(); }
                if (state.seconds >= data.threshold * 60) triggerAlarm();
            }, 1000);
        }

        function stopTimer() {
            state.isRunning = false;
            clearInterval(timerInterval);
            document.getElementById('btn-text').textContent = "–ü—Ä–æ–¥—ä–ª–∂–∏";
            document.getElementById('btn-icon').textContent = "‚ñ∂";
            startBtn.classList.replace('btn-stop-gradient', 'btn-start-gradient');
        }

        function updateUI() {
            const mins = Math.floor(state.seconds / 60);
            const secs = state.seconds % 60;
            timerDisplay.textContent = `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
            progressBar.style.width = `${Math.min(100, (state.seconds / (data.threshold * 60)) * 100)}%`;
        }

        function updateStats() {
            document.getElementById('cortisol-val').textContent = state.cortisol;
            document.getElementById('endorphin-val').textContent = state.endorphins;
        }

        function triggerAlarm() {
            stopTimer();
            const mission = data.missions[Math.floor(Math.random() * data.missions.length)];
            document.getElementById('mission-title').textContent = mission.title;
            document.getElementById('mission-desc').textContent = mission.desc;
            document.getElementById('mission-modal').classList.remove('hidden');
        }

        document.getElementById('complete-mission-btn').addEventListener('click', () => {
            state.cortisol = Math.max(0, state.cortisol - 15);
            state.endorphins += 20;
            document.getElementById('mission-modal').classList.add('hidden');
            document.getElementById('bravo-stats').textContent = "-15 –ö–û–†–¢–ò–ó–û–õ | +20 –ï–ù–î–û–†–§–ò–ù–ò";
            document.getElementById('bravo-modal').classList.remove('hidden');
            updateStats();
        });

        function closeBravo() {
            document.getElementById('bravo-modal').classList.add('hidden');
            resetApp();
        }

        document.getElementById('refuse-mission-btn').addEventListener('click', () => {
            document.getElementById('mission-modal').classList.add('hidden');
            setupEthics();
            document.getElementById('ethics-modal').classList.remove('hidden');
        });

        function setupEthics() {
            const container = document.getElementById('ethics-container');
            container.innerHTML = '';
            data.ethics.forEach((q, i) => {
                container.innerHTML += `
                    <div class="bg-white/10 p-6 rounded-2xl border border-white/20 flex flex-col justify-between backdrop-blur-sm">
                        <p class="text-white text-[10px] font-bold uppercase tracking-widest mb-5 leading-relaxed">${q}</p>
                        <div class="flex gap-2">
                            <label class="flex-1">
                                <input type="radio" name="q${i}" value="yes" class="hidden peer" required>
                                <div class="w-full py-2.5 bg-white/5 border border-white/10 text-white/40 text-[9px] font-black text-center rounded-lg peer-checked:bg-emerald-500 peer-checked:text-white peer-checked:border-emerald-500 transition-all">–î–ê</div>
                            </label>
                            <label class="flex-1">
                                <input type="radio" name="q${i}" value="no" class="hidden peer">
                                <div class="w-full py-2.5 bg-white/5 border border-white/10 text-white/40 text-[9px] font-black text-center rounded-lg peer-checked:bg-white peer-checked:text-slate-900 peer-checked:border-white transition-all">–ù–ï</div>
                            </label>
                        </div>
                    </div>
                `;
            });
        }

        document.getElementById('ethics-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            let yesCount = 0; let answeredCount = 0;
            for (let pair of formData.entries()) { answeredCount++; if (pair[1] === 'yes') yesCount++; }
            if (answeredCount < 6) { document.getElementById('ethics-error').classList.remove('hidden'); return; }
            document.getElementById('ethics-modal').classList.add('hidden');
            if (yesCount >= 3) document.getElementById('crisis-panel').classList.remove('hidden');
            else finalizeRefusal();
        });

        function finalizeCrisis() { document.getElementById('crisis-panel').classList.add('hidden'); finalizeRefusal(); }
        function finalizeRefusal() { state.endorphins = Math.max(0, state.endorphins - 20); updateStats(); resetApp(); }
        function resetApp() { state.seconds = 0; updateUI(); stopTimer(); document.getElementById('btn-text').textContent = "–°—Ç–∞—Ä—Ç –Ω–∞ —Ä–µ–∂–∏–º–∞"; startBtn.classList.replace('btn-stop-gradient', 'btn-start-gradient'); }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js').catch(err => console.log('SW error:', err));
            });
        }
    </script>
</body>
</html>

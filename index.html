<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ—Ü–∏–∞–ª–µ–Ω –∫–æ–º–ø–∞—Å</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <meta name="theme-color" content="#22c55e">

    <!-- Tailwind CSS (via CDN for simplicity) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Roboto', sans-serif; user-select: none; }
        .hidden-screen { display: none; }
        .pulse-anim { animation: pulse-red 2s infinite; }
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 h-screen flex flex-col overflow-hidden">

    <!-- --- SECTION I: HEADER & MOTTOS --- -->
    <header class="bg-green-600 text-white p-4 shadow-md z-10">
        <div class="flex items-center justify-between">
            <h1 class="text-xl font-bold">–°–æ—Ü–∏–∞–ª–µ–Ω –∫–æ–º–ø–∞—Å</h1>
            <div id="connection-status" class="w-3 h-3 rounded-full bg-green-300 animate-pulse"></div>
        </div>
        <!-- Rotating Motto Area -->
        <div class="mt-2 text-center text-sm italic opacity-90 h-6 overflow-hidden">
            <p id="motto-display">–ó–∞—Ä–µ–∂–¥–∞–Ω–µ –Ω–∞ –º—ä–¥—Ä–æ—Å—Ç–∏...</p>
        </div>
    </header>

    <!-- --- MAIN CONTENT --- -->
    <main class="flex-grow flex flex-col items-center justify-center p-4 relative">
        
        <!-- INITIAL START SCREEN (To allow Audio Context) -->
        <div id="start-overlay" class="absolute inset-0 bg-white z-50 flex flex-col items-center justify-center p-8 text-center">
            <img src="icon.svg" class="w-32 h-32 mb-6" alt="Logo">
            <h2 class="text-2xl font-bold mb-4 text-green-700">–î–æ–±—Ä–µ –¥–æ—à–ª–∏ –≤ –°–æ—Ü–∏–∞–ª–Ω–∏—è –∫–æ–º–ø–∞—Å</h2>
            <p class="mb-8 text-gray-600">–ë–∞–ª–∞–Ω—Å–∏—Ä–∞–π –≤—Ä–µ–º–µ—Ç–æ —Å–∏. –û—Å—Ç–∞–Ω–∏ —á–æ–≤–µ–∫.</p>
            <button onclick="startApp()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transform transition hover:scale-105">
                –°–¢–ê–†–¢–ò–†–ê–ô –ö–û–ú–ü–ê–°–ê
            </button>
        </div>

        <!-- DASHBOARD (TIMER & HORMONES) -->
        <div id="dashboard" class="w-full max-w-md space-y-6 hidden-screen">
            
            <!-- SECTION II: TIMERS -->
            <div class="bg-white rounded-2xl shadow-lg p-6 text-center border-t-4 border-green-500">
                <p class="text-gray-500 text-sm uppercase tracking-wide">–í—Ä–µ–º–µ –ø—Ä–µ–¥ –µ–∫—Ä–∞–Ω–∞</p>
                <div class="text-6xl font-bold text-gray-800 my-2 font-mono" id="main-timer">00:00:00</div>
                <div class="flex justify-between text-xs text-gray-400 px-4">
                    <span>–û–±—â–æ –≤—Ä–µ–º–µ: <span id="total-time">00:00:00</span></span>
                    <span>–ê–ª–∞—Ä–º–∞ —Å–ª–µ–¥: <span id="time-remaining">40</span> –º–∏–Ω</span>
                </div>
            </div>

            <!-- SECTION II: HORMONAL BALANCE -->
            <div class="bg-white rounded-2xl shadow-lg p-6 space-y-4">
                <h3 class="font-bold text-gray-700 text-center mb-2">–•–æ—Ä–º–æ–Ω–∞–ª–µ–Ω –±–∞–ª–∞–Ω—Å</h3>
                
                <!-- Cortisol -->
                <div>
                    <div class="flex justify-between text-sm mb-1">
                        <span>–ö–æ—Ä—Ç–∏–∑–æ–ª (–°—Ç—Ä–µ—Å)</span>
                        <span id="cortisol-val" class="font-bold text-red-500">10%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="cortisol-bar" class="bg-red-500 h-2.5 rounded-full transition-all duration-500" style="width: 10%"></div>
                    </div>
                </div>

                <!-- Endorphins -->
                <div>
                    <div class="flex justify-between text-sm mb-1">
                        <span>–ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏ (–©–∞—Å—Ç–∏–µ)</span>
                        <span id="endorphin-val" class="font-bold text-green-500">90%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="endorphin-bar" class="bg-green-500 h-2.5 rounded-full transition-all duration-500" style="width: 90%"></div>
                    </div>
                </div>
                <p class="text-xs text-gray-400 text-center mt-2 italic">* –ù–∏–≤–∞—Ç–∞ —Å–µ –ø—Ä–æ–º–µ–Ω—è—Ç –Ω–∞ –≤—Å–µ–∫–∏ 5 –º–∏–Ω—É—Ç–∏ –ø—Ä–µ—Å—Ç–æ–π.</p>
            </div>
        </div>
    </main>

    <!-- --- MODALS --- -->

    <!-- ALARM MODAL (Cruzo Alarm) -->
    <div id="alarm-modal" class="fixed inset-0 bg-red-900 bg-opacity-95 z-40 hidden-screen flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-xl p-8 max-w-sm w-full text-center shadow-2xl pulse-anim">
            <div class="text-6xl mb-4">üö®</div>
            <h2 class="text-3xl font-bold text-red-600 mb-2">–ö–†–£–ó–û –ê–õ–ê–†–ú!</h2>
            <p class="text-gray-700 mb-6">–ü—Ä–µ–º–∏–Ω–∞—Ö—Ç–µ –ø—Ä–∞–≥–∞ –æ—Ç <span class="font-bold">40 –º–∏–Ω—É—Ç–∏</span>. –ù–∏–≤–∞—Ç–∞ –Ω–∞ –∫–æ—Ä—Ç–∏–∑–æ–ª —Å–∞ –∫—Ä–∏—Ç–∏—á–Ω–∏.</p>
            
            <button onclick="generateMission()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg mb-3 shadow transition">
                –ò–ó–ü–™–õ–ù–ò –§–í–° –ú–ò–°–ò–Ø
            </button>
            <button onclick="triggerEthicalFilter()" class="w-full bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-4 rounded-lg transition">
                –ù–µ –º–∏ —Å–µ –ø—Ä–∞–≤–∏ (–û—Ç–∫–∞–∑)
            </button>
        </div>
    </div>

    <!-- MISSION MODAL (Section III) -->
    <div id="mission-modal" class="fixed inset-0 bg-green-900 bg-opacity-90 z-40 hidden-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 max-w-sm w-full text-center shadow-2xl">
            <h3 class="text-xl font-bold text-green-700 mb-1" id="mission-title">–ó–∞–≥–ª–∞–≤–∏–µ</h3>
            <div class="bg-gray-100 h-40 rounded-lg mb-4 flex items-center justify-center text-gray-400 border-2 border-dashed border-gray-300 overflow-hidden relative">
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                   <span class="text-4xl opacity-20">‚ñ∂Ô∏è</span>
                </div>
                <!-- Placeholder for video integration -->
                <p class="text-xs px-4">–¢—É–∫ —â–µ —Å–µ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–∞ –≤–∏–¥–µ–æ—Ç–æ –∑–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ—Ç–æ</p>
            </div>
            <p class="text-gray-800 font-medium mb-6 text-lg" id="mission-instruction">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è...</p>
            
            <button onclick="completeMission()" class="w-full bg-green-600 text-white font-bold py-3 rounded-lg shadow hover:bg-green-500 transition">
                –ì–û–¢–û–í–û! (–í—ä–∑—Å—Ç–∞–Ω–æ–≤–∏ –±–∞–ª–∞–Ω—Å–∞)
            </button>
        </div>
    </div>

    <!-- ETHICAL FILTER (Section IV) -->
    <div id="ethical-modal" class="fixed inset-0 bg-gray-900 bg-opacity-95 z-50 hidden-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-xl p-6 max-w-sm w-full shadow-2xl">
            <h3 class="text-xl font-bold text-gray-800 mb-4 border-b pb-2">–ï—Ç–∏—á–µ–Ω —Ñ–∏–ª—Ç—ä—Ä</h3>
            <p class="text-sm text-gray-500 mb-4">–û—Ç–≥–æ–≤–æ—Ä–µ—Ç–µ —á–µ—Å—Ç–Ω–æ, –∑–∞ –¥–∞ –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ.</p>
            
            <form id="ethical-form" class="space-y-4">
                <div class="flex items-start">
                    <input type="checkbox" id="q1" class="mt-1 mr-3 w-5 h-5 accent-red-500">
                    <label for="q1" class="text-sm">–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—Ç–µ –ª–∏ –¥–∞ —Å–∏ –≥–æ–≤–æ—Ä–∏—Ç–µ —Å AI –≤–º–µ—Å—Ç–æ —Å –∂–∏–≤ —á–æ–≤–µ–∫?</label>
                </div>
                <div class="flex items-start">
                    <input type="checkbox" id="q2" class="mt-1 mr-3 w-5 h-5 accent-red-500">
                    <label for="q2" class="text-sm">–ü—Ä–æ–ø—É—Å–∫–∞—Ç–µ –ª–∏ —Ö—Ä–∞–Ω–µ–Ω–µ –∑–∞—Ä–∞–¥–∏ —Ç–æ–≤–∞, —á–µ –Ω–µ –≤–∏ —Å–µ —Å—Ç–∞–≤–∞ –æ—Ç –∫–æ–º–ø—é—Ç—ä—Ä–∞?</label>
                </div>
                <div class="flex items-start">
                    <input type="checkbox" id="q3" class="mt-1 mr-3 w-5 h-5 accent-red-500">
                    <label for="q3" class="text-sm">–ù–∞–º–∏—Ä–∞—Ç–µ –ª–∏ —É—Ç–µ—Ö–∞ –≤ –¥–∏–≥–∏—Ç–∞–ª–Ω–∏—è —Å–≤—è—Ç?</label>
                </div>
            </form>

            <button onclick="processEthicalFilter()" class="w-full mt-6 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition">
                –ü–û–¢–í–™–†–î–ò
            </button>
        </div>
    </div>

    <!-- CRISIS CONTACTS (Case Adam Rain) -->
    <div id="crisis-modal" class="fixed inset-0 bg-red-950 z-[60] hidden-screen flex flex-col items-center justify-center p-6 text-center text-white">
        <div class="mb-6 text-6xl">üÜò</div>
        <h2 class="text-3xl font-bold text-red-400 mb-4">–í–ù–ò–ú–ê–ù–ò–ï: –í–ò–°–û–ö –†–ò–°–ö</h2>
        <p class="mb-8 text-lg opacity-90">–í–∏–µ –ø–æ–∫–∞–∑–≤–∞—Ç–µ –ø—Ä–∏–∑–Ω–∞—Ü–∏ –Ω–∞ –¥–∏–≥–∏—Ç–∞–ª–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç (–°–∏–Ω–¥—Ä–æ–º –Ω–∞ –ê–¥–∞–º –†–µ–π–Ω). –ò—Å—Ç–∏–Ω—Å–∫–∞—Ç–∞ –≤—Ä—ä–∑–∫–∞ –µ —Å —Ö–æ—Ä–∞—Ç–∞, –Ω–µ —Å –º–∞—à–∏–Ω–∏—Ç–µ.</p>
        
        <div class="w-full max-w-sm bg-white/10 backdrop-blur-md rounded-xl p-6 mb-4 text-left border border-red-500/30">
            <p class="text-xs uppercase tracking-widest text-red-300 mb-1">–ù–∞—Ü–∏–æ–Ω–∞–ª–Ω–∞ –ª–∏–Ω–∏—è –∑–∞ –ø–æ–¥–∫—Ä–µ–ø–∞</p>
            <a href="tel:116111" class="text-3xl font-bold block mb-4 hover:text-red-300 transition">üìû 116 111</a>
            
            <p class="text-xs uppercase tracking-widest text-red-300 mb-1">–ü—Å–∏—Ö–æ—Å–æ—Ü–∏–∞–ª–Ω–∞ –ø–æ–¥–∫—Ä–µ–ø–∞ (–ë–ß–ö)</p>
            <a href="tel:080088001" class="text-2xl font-bold block hover:text-red-300 transition">üìû 0 800 88 001</a>
        </div>

        <button onclick="returnFromCrisis()" class="mt-4 text-sm text-gray-400 underline hover:text-white">
            –†–∞–∑–±—Ä–∞—Ö, –∏—Å–∫–∞–º –¥–∞ —Å–µ –≤—ä—Ä–Ω–∞ –∏ –¥–∞ –∏–∑–ø—ä–ª–Ω—è –º–∏—Å–∏—è—Ç–∞
        </button>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA FROM DOCUMENT ---
        const MOTTOS = [
            "–°–ø–∞–∑–≤–∞–π –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞",
            "–ü–æ-–ø—Ä–∏—è—Ç–Ω–æ —Å —á–æ–≤–µ–∫ –¥–æ —Ç–µ–±",
            "–ß–æ–≤–µ–∫ —Å —á–æ–≤–µ–∫",
            "–¢—Ä—É–¥—ä—Ç —Å–ø–∞—Å—è–≤–∞",
            "–í–∏–Ω–∞–≥–∏ –∏–º–∞ –∫–∞–∫"
        ];

        const MISSIONS = [
            { title: "–ö–ª—è–∫–∞–Ω–∏—è", instr: "–ù–∞–ø—Ä–∞–≤–∏ 3 —Å–µ—Ä–∏–∏ –ø–æ 15 –∫–ª—è–∫–∞–Ω–∏—è." },
            { title: "–†–∞–∑—Ö–æ–¥–∫–∞", instr: "5 –º–∏–Ω—É—Ç–∏ –±—ä—Ä–∑–∞ —Ä–∞–∑—Ö–æ–¥–∫–∞ –∏–∑ —Å—Ç–∞—è—Ç–∞/–∫–æ—Ä–∏–¥–æ—Ä–∞." },
            { title: "–ì–∏–º–Ω–∞—Å—Ç–∏–∫–∞", instr: "–ò–∑–ø—ä–Ω–∏ —Ä—ä—Ü–µ –Ω–∞–¥ –≥–ª–∞–≤–∞—Ç–∞ –∏ –Ω–∞–ø—Ä–∞–≤–∏ 10 –∫—Ä—ä–≥–æ–≤–∏ –¥–≤–∏–∂–µ–Ω–∏—è." },
            { title: "–ì—Ä–µ–±–∞–Ω–µ", instr: "–°–µ–¥–Ω–∏ –∏–∑–ø—Ä–∞–≤–µ–Ω –∏ –Ω–∞–ø—Ä–∞–≤–∏ 20 –ø–æ–≤–¥–∏–≥–∞–Ω–∏—è –Ω–∞ –∫–æ–ª–µ–Ω–µ—Ç–µ –∫—ä–º –≥—ä—Ä–¥–∏—Ç–µ." }
        ];

        const CONFIG = {
            alarmThresholdMin: 40, // 40 minutes limit
            cortisolStart: 10,
            endorphinStart: 90,
            cortisolTick: 5,   // +5 every 5 mins
            endorphinTick: -5, // -5 every 5 mins
            cortisolMission: -15,
            endorphinMission: 20
        };

        // --- STATE ---
        let state = {
            startTime: null,      // Timestamp when current session started
            totalTimeStart: null, // Timestamp when app first opened
            lastHormoneUpdate: null,
            alarmActive: false,
            cortisol: CONFIG.cortisolStart,
            endorphins: CONFIG.endorphinStart,
            timerInterval: null
        };

        // --- AUDIO (Generated Beep) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playAlarmSound() {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(440, audioCtx.currentTime); // A4
            oscillator.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.5);
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        }

        // --- INITIALIZATION ---
        function startApp() {
            // Unhide Dashboard, hide Start Screen
            document.getElementById('start-overlay').classList.add('hidden-screen');
            document.getElementById('dashboard').classList.remove('hidden-screen');
            
            // Resume Audio Context (browsers block auto-play)
            if (audioCtx.state === 'suspended') audioCtx.resume();

            // Init Timers
            const now = Date.now();
            state.startTime = now;
            state.totalTimeStart = now;
            state.lastHormoneUpdate = now;

            // Start Logic
            state.timerInterval = setInterval(gameLoop, 1000);
            rotateMottos();
            updateHormonesUI();
        }

        // --- CORE LOOP (Runs every second) ---
        function gameLoop() {
            const now = Date.now();
            
            // 1. Calculate durations (ms)
            const sessionElapsed = now - state.startTime;
            const totalElapsed = now - state.totalTimeStart;

            // 2. Update UI Timers
            document.getElementById('main-timer').textContent = formatTime(sessionElapsed);
            document.getElementById('total-time').textContent = formatTime(totalElapsed);
            
            // Update "Alarm After" countdown
            const remainingSec = (CONFIG.alarmThresholdMin * 60) - Math.floor(sessionElapsed / 1000);
            const remainingMin = Math.ceil(remainingSec / 60);
            document.getElementById('time-remaining').textContent = remainingMin > 0 ? remainingMin : 0;

            // 3. Check Hormones (Every 5 minutes = 300,000 ms)
            if (now - state.lastHormoneUpdate >= 300000) {
                applyHormoneTick();
                state.lastHormoneUpdate = now;
            }

            // 4. Check Alarm Threshold
            if (!state.alarmActive && sessionElapsed >= CONFIG.alarmThresholdMin * 60 * 1000) {
                triggerAlarm();
            }
        }

        // --- LOGIC FUNCTIONS ---

        function triggerAlarm() {
            state.alarmActive = true;
            playAlarmSound();
            
            // Loop alarm sound every 2 seconds until resolved
            const alarmLoop = setInterval(() => {
                if(!state.alarmActive) clearInterval(alarmLoop);
                else playAlarmSound();
            }, 2000);

            document.getElementById('alarm-modal').classList.remove('hidden-screen');
        }

        function applyHormoneTick() {
            // Cortisol UP, Endorphins DOWN
            updateHormoneValues(CONFIG.cortisolTick, CONFIG.endorphinTick);
        }

        function updateHormoneValues(cortChange, endoChange) {
            state.cortisol = Math.min(100, Math.max(0, state.cortisol + cortChange));
            state.endorphins = Math.min(100, Math.max(0, state.endorphins + endoChange));
            updateHormonesUI();
        }

        function updateHormonesUI() {
            const cBar = document.getElementById('cortisol-bar');
            const eBar = document.getElementById('endorphin-bar');
            
            cBar.style.width = state.cortisol + '%';
            document.getElementById('cortisol-val').textContent = state.cortisol + '%';
            
            eBar.style.width = state.endorphins + '%';
            document.getElementById('endorphin-val').textContent = state.endorphins + '%';

            // Visual feedback colors based on levels
            if(state.cortisol > 70) cBar.classList.replace('bg-red-500', 'bg-red-700');
            else cBar.classList.replace('bg-red-700', 'bg-red-500');
        }

        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const h = Math.floor(totalSeconds / 3600).toString().padStart(2, '0');
            const m = Math.floor((totalSeconds % 3600) / 60).toString().padStart(2, '0');
            const s = (totalSeconds % 60).toString().padStart(2, '0');
            return `${h}:${m}:${s}`;
        }

        function rotateMottos() {
            const display = document.getElementById('motto-display');
            let index = 0;
            display.textContent = MOTTOS[0];
            
            setInterval(() => {
                index = (index + 1) % MOTTOS.length;
                // Simple fade effect
                display.style.opacity = 0;
                setTimeout(() => {
                    display.textContent = MOTTOS[index];
                    display.style.opacity = 1;
                }, 500);
            }, 5000); // Rotate every 5 seconds
        }

        // --- INTERACTION HANDLERS ---

        function generateMission() {
            // Close Alarm Modal
            document.getElementById('alarm-modal').classList.add('hidden-screen');
            // Show Mission Modal
            document.getElementById('mission-modal').classList.remove('hidden-screen');
            
            // Random Mission
            const mission = MISSIONS[Math.floor(Math.random() * MISSIONS.length)];
            document.getElementById('mission-title').textContent = mission.title;
            document.getElementById('mission-instruction').textContent = mission.instr;
            
            state.alarmActive = false; // Stop sound
        }

        function completeMission() {
            // Apply Mission Benefits
            updateHormoneValues(CONFIG.cortisolMission, CONFIG.endorphinMission);
            
            // Reset Session Timer (start fresh 40 min cycle)
            state.startTime = Date.now(); 
            // Reset Hormone Tick Timer
            state.lastHormoneUpdate = Date.now();

            // Close Modal
            document.getElementById('mission-modal').classList.add('hidden-screen');
            
            alert(`–ú–∏—Å–∏—è –∏–∑–ø—ä–ª–Ω–µ–Ω–∞!\n–ö–æ—Ä—Ç–∏–∑–æ–ª: ${CONFIG.cortisolMission}\n–ï–Ω–¥–æ—Ä—Ñ–∏–Ω–∏: +${CONFIG.endorphinMission}`);
        }

        function triggerEthicalFilter() {
            document.getElementById('alarm-modal').classList.add('hidden-screen');
            document.getElementById('ethical-modal').classList.remove('hidden-screen');
            state.alarmActive = false; // Silence alarm while thinking
            
            // Reset form
            document.getElementById('ethical-form').reset();
        }

        function processEthicalFilter() {
            const q1 = document.getElementById('q1').checked;
            const q2 = document.getElementById('q2').checked;
            const q3 = document.getElementById('q3').checked;
            
            const yesCount = [q1, q2, q3].filter(Boolean).length;

            if (yesCount >= 2) {
                // HIGH RISK -> Crisis Mode
                document.getElementById('ethical-modal').classList.add('hidden-screen');
                document.getElementById('crisis-modal').classList.remove('hidden-screen');
            } else {
                // Low Risk -> Force back to Mission choice (cannot just skip)
                alert("–ï—Ç–∏—á–Ω–∏—è—Ç —Ñ–∏–ª—Ç—ä—Ä –≤–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–≤–∞: –ù–µ –ø–æ–¥—Ü–µ–Ω—è–≤–∞–π—Ç–µ –Ω—É–∂–¥–∞—Ç–∞ –æ—Ç –ø–æ—á–∏–≤–∫–∞. –ú–æ–ª—è, –∏–∑–ø—ä–ª–Ω–µ—Ç–µ –º–∏—Å–∏—è.");
                document.getElementById('ethical-modal').classList.add('hidden-screen');
                generateMission(); // Send them back to mission
            }
        }

        function returnFromCrisis() {
            // From Crisis screen back to Mission choice
            document.getElementById('crisis-modal').classList.add('hidden-screen');
            generateMission();
        }

    </script>
</body>
</html>
